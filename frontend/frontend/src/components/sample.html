<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>Piggy ‚Äî Cosmetic Shop (No Stands + Proper Image Load)</title>
<style>
  :root{ --ink:#111; --muted:#6b7280; --line:#e5e7eb; --accent:#ef5da8; --bg:#fff; }
  html,body{margin:0;background:var(--bg);color:var(--ink);font-family:Inter,system-ui,Arial}
  .wrap{max-width:1024px;margin:18px auto;padding:0 14px}
  .top{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}
  .carrots{font-weight:800}
  .btn{border:1px solid var(--line);background:#fff;border-radius:10px;padding:8px 10px;cursor:pointer}
  .note{font-size:12px;color:var(--muted)}
  .section{border:1px solid var(--line);border-radius:12px;background:#fff;margin-top:10px}
  .section h3{margin:0;padding:12px;border-bottom:1px solid var(--line)}
  .pad{padding:12px}
  .grid{display:grid;grid-template-columns: repeat(3,1fr);gap:12px}
  .card{border:1px solid var(--line);border-radius:12px;background:#fff;display:flex;flex-direction:column;overflow:hidden}
  .card canvas{width:100%;height:200px;display:block;background:#fff}
  .meta{display:flex;align-items:center;justify-content:space-between;padding:10px 12px}
  .name{font-weight:800}
  .price{font-variant-numeric:tabular-nums;color:#374151}
  .card button{margin:0 12px 12px;border:1px solid #111;background:#fff;border-radius:10px;padding:11px 12px;font-weight:800;cursor:pointer}
  .card button.own{border-color:var(--line);color:#374151}
  .card button.equip{border-color:var(--accent);color:#ef5da8}
  .cta{border-color:var(--accent)!important;color:#ef5da8!important;background:#fff;box-shadow:0 0 0 1px rgba(239,93,168,.05),0 2px 0 rgba(239,93,168,.15) inset}
  #capsuleRow{display:grid;grid-template-columns: 1.4fr 1fr;gap:14px;align-items:center}
  .toast{position:fixed;left:50%;top:18px;transform:translateX(-50%);background:#111;color:#fff;padding:10px 14px;border-radius:10px;opacity:0;transition:opacity .2s, transform .2s;pointer-events:none}
  .toast.show{opacity:1;transform:translateX(-50%) translateY(6px)}

  .modal{position:fixed;inset:0;background:rgba(0,0,0,.55);display:none;align-items:center;justify-content:center;z-index:50;}
  .modal.show{display:flex}
  .modal .panel{width:min(920px,96vw);border-radius:16px;overflow:hidden;box-shadow:0 30px 80px rgba(0,0,0,.35), 0 0 0 1px rgba(255,255,255,.06) inset;}
  .modal canvas{display:block;width:100%;height:auto;background:#0b0f14}
  .modal .skip{position:absolute;right:20px;top:16px;background:#fff;border:0;border-radius:999px;padding:8px 12px;font-weight:800;cursor:pointer}
</style>
</head>
<body>
<div class="wrap">
  <div class="top">
    <div style="display:flex;align-items:center;gap:10px">
      <button class="btn" onclick="history.back()">‚Üê Back</button>
      <div class="carrots">Carrots: <span id="carrots">0</span> ü•ï</div>
    </div>
    <div class="note">Equip choices persist and are used on your home/battle scenes.</div>
  </div>

  <div class="section">
    <h3>üê∑ Pig Capsule ‚Äî 50 ü•ï</h3>
    <div class="pad" id="capsuleRow">
      <canvas id="capsulePrev" width="520" height="240"></canvas>
      <div>
        <button id="buyCapsule" class="btn cta">Buy Capsule (50 ü•ï)</button>
        <div id="capsuleMsg" class="note" style="margin-top:10px">Contains one of: Black Pig, Angel Pig, Roasted Pig.</div>
      </div>
    </div>
  </div>

  <div class="grid">
    <div class="section">
      <h3>Pigs</h3>
      <div class="pad" id="pigsGrid" style="display:grid;grid-template-columns:1fr;gap:10px"></div>
    </div>
    <div class="section">
      <h3>Cosmetics</h3>
      <div class="pad" id="cosGrid" style="display:grid;grid-template-columns:1fr;gap:10px"></div>
    </div>
    <div class="section">
      <h3>Equipped</h3>
      <div class="pad">
        <div id="equippedSummary" class="note">Pig: Pink Pig ‚Ä¢ Cosmetic: None</div>
        <canvas id="equippedPrev" width="300" height="200" style="margin-top:8px"></canvas>
      </div>
    </div>
  </div>
</div>

<div id="toast" class="toast"></div>

<div id="unboxModal" class="modal" aria-hidden="true">
  <button class="skip" id="skipUnbox">Skip</button>
  <div class="panel">
    <canvas id="unboxCanvas" width="900" height="320"></canvas>
  </div>
</div>

<script>
/* ================ Save ================ */
const KEY = "piggy-home-v2";
const defaultState = {
  level:0, xp:0, carrots:0, hunger:100, lastTick:Date.now(), schedule:[],
  pigsOwned:["pink"], cosmeticsOwned:[], equippedPig:"pink", equippedCosmetic:null
};
function loadState(){ try{ return {...defaultState, ...(JSON.parse(localStorage.getItem(KEY))||{})}; }catch{ return {...defaultState}; } }
let S = loadState();
const RESET_FLAG = KEY + "_carrots_reset_v1";
if (!localStorage.getItem(RESET_FLAG)) { S.carrots = 0; localStorage.setItem(RESET_FLAG,"1"); saveState(); }
function saveState(){ localStorage.setItem(KEY, JSON.stringify(S)); }

/* ================ DOM ================ */
const carrotsEl = document.getElementById('carrots');
const toastEl   = document.getElementById('toast');
const capsuleMsg= document.getElementById('capsuleMsg');
const capsulePrev = document.getElementById('capsulePrev');
const pigsGrid  = document.getElementById('pigsGrid');
const cosGrid   = document.getElementById('cosGrid');
const equippedPrev = document.getElementById('equippedPrev');
const equippedSummary = document.getElementById('equippedSummary');
const unboxModal = document.getElementById('unboxModal');
const unboxCanvas= document.getElementById('unboxCanvas');
const skipUnbox  = document.getElementById('skipUnbox');
function toast(msg){ toastEl.textContent = msg; toastEl.classList.add('show'); setTimeout(()=>toastEl.classList.remove('show'), 1400); }
function updateCarrots(){ carrotsEl.textContent = S.carrots|0; }

/* ================ Assets ================ */
const basePig = new Image();
basePig.src = "pig1.png";

/* Helper: fire cb immediately if ready, otherwise once on load */
function onBasePigReady(cb){
  if (basePig.complete && basePig.naturalWidth > 0) cb();
  else basePig.addEventListener('load', cb, { once:true });
}

/* ================ Drawing ================ */
function drawStand(ctx, cx, cy, w=110, h=16, alpha=0.18){
  ctx.save(); ctx.globalAlpha=alpha; ctx.fillStyle="#000";
  ctx.beginPath(); ctx.ellipse(cx, cy, w, h, 0, 0, Math.PI*2); ctx.fill();
  ctx.restore();
}
function roundRect(ctx,x,y,w,h,r){ ctx.beginPath(); ctx.moveTo(x+r,y); ctx.arcTo(x+w,y,x+w,y+h,r); ctx.arcTo(x+w,y+h,x,y+h,r); ctx.arcTo(x,y+h,x,y,r); ctx.arcTo(x,y,x+w,y,r); ctx.closePath(); }
function drawTopHat(ctx, cx, cy, scale=1){
  const s = 1.0*scale;
  ctx.save(); ctx.translate(cx, cy-8*s);
  ctx.fillStyle = "#101114"; roundRect(ctx, -34*s, -5*s, 68*s, 10*s, 6*s); ctx.fill();
  ctx.fillStyle = "#15161b"; roundRect(ctx, -22*s, -38*s, 44*s, 36*s, 6*s); ctx.fill();
  ctx.fillStyle = "#ef5da8"; ctx.fillRect(-22*s, -20*s, 44*s, 7*s);
  ctx.restore();
}
function drawTrafficCone(ctx, cx, cy, scale=1){
  const s = 1.0*scale;
  ctx.save(); ctx.translate(cx, cy-10);
  ctx.fillStyle = "#fb923c";
  ctx.beginPath();
  ctx.moveTo(0, -44*s);
  ctx.bezierCurveTo(10*s, -34*s, 22*s, -12*s, 26*s, 0);
  ctx.lineTo(-26*s, 0);
  ctx.bezierCurveTo(-22*s, -12*s, -10*s, -34*s, 0, -44*s);
  ctx.closePath(); ctx.fill();
  ctx.fillStyle = "#fff"; roundRect(ctx, -19*s, -18*s, 38*s, 8*s, 4*s); ctx.fill();
  ctx.fillStyle = "#ea580c"; roundRect(ctx, -30*s, 0, 60*s, 7*s, 4*s); ctx.fill();
  ctx.restore();
}
function drawAngelWings(ctx, size, locked=false){
  const stroke = Math.max(2, size * 0.02);
  ctx.save(); ctx.translate(0, -size*0.05);
  function wing(side=1){
    ctx.save();
    ctx.scale(side,1);
    ctx.translate(-size*0.44, -size*0.10);
    ctx.rotate(-0.12);
    ctx.fillStyle = locked ? "#e5e7eb" : "#fff";
    ctx.strokeStyle= locked ? "#d1d5db" : "#c7e0ff";
    ctx.lineWidth=stroke;
    ctx.beginPath();
    ctx.moveTo(0,0);
    ctx.quadraticCurveTo(-size*0.10, -size*0.08, -size*0.22, -size*0.02);
    ctx.quadraticCurveTo(-size*0.26,  size*0.10, -size*0.06,  size*0.14);
    ctx.quadraticCurveTo(-size*0.18,  size*0.06, 0,0);
    ctx.closePath(); ctx.fill(); ctx.stroke();
    ctx.fillStyle = locked ? "rgba(209,213,219,0.45)" : "rgba(199,224,255,0.35)";
    for(let i=0;i<3;i++){
      const f=i/3;
      ctx.beginPath();
      ctx.ellipse(-size*(0.18 - f*0.10), size*(0.02 + f*0.06),
                  size*(0.10 - f*0.03), size*(0.05 - f*0.015), -0.2, 0, Math.PI*2);
      ctx.fill();
    }
    ctx.restore();
  }
  wing(+1); wing(-1);
  ctx.restore();
}
function drawHalo(ctx, size, locked=false){
  const y=-size*0.44;
  ctx.save(); ctx.translate(0,y); ctx.rotate(-0.04);
  const glow = locked ? "rgba(229,231,235,0.35)" : "rgba(251,191,36,0.35)";
  const ring = locked ? "#d1d5db" : "#fbbf24";
  const inner= locked ? "#e5e7eb" : "#fde68a";
  ctx.globalAlpha=0.25; ctx.fillStyle=glow;
  ctx.beginPath(); ctx.ellipse(0,0,size*0.30,size*0.11,0,0,Math.PI*2); ctx.fill();
  ctx.globalAlpha=1;
  ctx.strokeStyle=ring; ctx.lineWidth=size*0.06;
  ctx.beginPath(); ctx.ellipse(0,0,size*0.26,size*0.08,0,0,Math.PI*2); ctx.stroke();
  ctx.strokeStyle=inner; ctx.lineWidth=size*0.035;
  ctx.beginPath(); ctx.ellipse(0,0,size*0.23,size*0.07,0,0,Math.PI*2); ctx.stroke();
  ctx.restore();
}

/* Show/Hide stand via flag */
function drawPigVariant(ctx, cx, cy, size, variant="pink", cosmetic=null, locked=false, showStand=true){
  ctx.save(); ctx.translate(cx, cy);

  if (variant==="angel") drawAngelWings(ctx, size, locked);

  let filter = "none";
  if (variant==="angel")   filter = "brightness(1.10) saturate(1.08)";
  if (variant==="black")   filter = "brightness(0.38) saturate(0) contrast(1.05)";
  if (variant==="roasted") filter = "sepia(1) saturate(2.2) hue-rotate(-20deg) brightness(1.12) contrast(1.05)";
  if (locked) filter += " grayscale(1) brightness(0.9)";

  if (basePig.complete && basePig.naturalWidth){
    ctx.filter = filter.trim();
    ctx.drawImage(basePig, -size/2, -size/2, size, size);
    ctx.filter = "none";
  } else {
    // lightweight placeholder (no stand)
    ctx.fillStyle="#f3f4f6"; roundRect(ctx, -size/2, -size/2, size, size, 12); ctx.fill();
  }

  if (cosmetic==="top-hat")      drawTopHat(ctx, 0, -size*0.34, size/68);
  if (cosmetic==="traffic-cone") drawTrafficCone(ctx, size*0.03, -size*0.33, size/68);
  if (variant==="angel")         drawHalo(ctx, size, locked);

  if (showStand) drawStand(ctx, 0, size*0.40, size*0.46, size*0.12);
  ctx.restore();
}

/* ================ Capsule preview ================ */
const COLORS = ["#facc15","#22c55e","#fb7185","#f97316","#e5e7eb","#a78bfa"];
function shade(hex, amt){ let c=hex.replace('#',''); if(c.length===3)c=c.split('').map(x=>x+x).join(''); const n=parseInt(c,16);
  let r=(n>>16)+amt,g=(n>>8&255)+amt,b=(n&255)+amt; r=Math.max(0,Math.min(255,r)); g=Math.max(0,Math.min(255,g)); b=Math.max(0,Math.min(255,b));
  return '#'+(r<<16|g<<8|b).toString(16).padStart(6,'0');
}
function sparkle(g,x,y,r){ g.save(); g.translate(x,y); g.fillStyle="rgba(255,255,255,.85)";
  g.beginPath(); g.moveTo(0,-r); g.lineTo(r*.4,0); g.lineTo(0,r); g.lineTo(-r*.4,0); g.closePath(); g.fill(); g.restore(); }
function drawCapsule(g, t, baseColor){
  g.clearRect(0,0,g.canvas.width,g.canvas.height);
  g.fillStyle="#fff"; g.fillRect(0,0,g.canvas.width,g.canvas.height);
  drawStand(g, 210, 170, 70, 12, .22);
  const grad=g.createLinearGradient(120,150,120,210);
  grad.addColorStop(0,baseColor); grad.addColorStop(1,shade(baseColor,-18));
  g.fillStyle=grad; roundRect(g, 150, 150, 140, 56, 18); g.fill();
  g.fillStyle="rgba(226,242,255,.85)"; g.beginPath(); g.ellipse(220, 120, 80, 70, 0, Math.PI, 0); g.fill();
  const bob=Math.sin(t*2)*4;
  drawPigVariant(g, 220, 120 + bob, 70, ["pink","black","angel","roasted"][Math.floor((t/2)%4)], null, false, false);
  g.fillStyle="rgba(255,255,255,.86)"; g.beginPath(); g.ellipse(250, 90, 30, 10, 0, 0, Math.PI*2); g.fill();
  sparkle(g, 190, 90+bob*0.2, 3); sparkle(g, 245, 70-bob*0.1, 3.6); sparkle(g, 232, 52+bob*0.1, 2.2);
}
let t0 = performance.now(), colorIndex = 0;
function capLoop(now){
  const t=(now-t0)/1000; const g=capsulePrev.getContext('2d');
  drawCapsule(g, t, COLORS[colorIndex]);
  if (Math.floor(t/2.4)!==Math.floor((t-1/60)/2.4)) colorIndex=(colorIndex+1)%COLORS.length;
  requestAnimationFrame(capLoop);
}
requestAnimationFrame(capLoop);

/* ================ Catalog ================ */
const PIGS = [
  { id:"pink",    name:"Pink Pig" },
  { id:"black",   name:"Black Pig" },
  { id:"angel",   name:"Angel Pig" },
  { id:"roasted", name:"Roasted Pig" },
];
const COSMETICS = [
  { id:"top-hat",      name:"Top Hat",      price:15 },
  { id:"traffic-cone", name:"Traffic Cone", price:25 },
];

function canAfford(cost){ return (S.carrots|0) >= cost; }
function spend(cost){ if(!canAfford(cost)){ toast("Not enough carrots!"); return false; } S.carrots -= cost; updateCarrots(); saveState(); return true; }
function grantPig(id){
  if (!S.pigsOwned.includes(id)) { S.pigsOwned.push(id); S.equippedPig=id; saveState(); renderAll(); return {dup:false, id}; }
  return {dup:true, id};
}

/* ================ Unboxing animation ================ */
function unboxCapsule(pool){
  return new Promise(resolve=>{
    const g = unboxCanvas.getContext('2d');
    const W = unboxCanvas.width, H = unboxCanvas.height;
    unboxModal.classList.add('show');
    let running = true;
    skipUnbox.onclick = ()=>{ running=false; };

    const result = pool[Math.floor(Math.random()*pool.length)];
    const reel = [];
    const choices = ["pink",...pool,"?",...pool,"?","black","roasted","angel","?"];
    for (let i=0;i<18;i++) reel.push(choices[i%choices.length]);
    reel.push(result); reel.push("?", "black");

    const ITEM_W = 160;
    let x = 0, speed = 900;
    const centerX = W/2;
    const targetIndex = reel.length-3;
    const targetX = targetIndex*ITEM_W + ITEM_W/2;

    const parts = [];
    function burst(){
      for(let i=0;i<120;i++){
        parts.push({x:centerX,y:H*0.42,vx:(Math.random()-0.5)*420,vy:(Math.random()-0.9)*520,a:1,r:2+Math.random()*2,g:`hsl(${Math.random()*360},90%,70%)`});
      }
    }

    let last = performance.now(); let stopped=false; let hold=0;
    function frame(now){
      const dt = (now-last)/1000; last=now;
      g.clearRect(0,0,W,H);
      const bg = g.createLinearGradient(0,0,W,H);
      bg.addColorStop(0,"#1f0c3a"); bg.addColorStop(1,"#0b223c");
      g.fillStyle=bg; g.fillRect(0,0,W,H);

      g.save();
      g.strokeStyle="rgba(255,255,255,.15)"; g.lineWidth=2;
      g.fillStyle="rgba(255,255,255,.06)";
      roundRect(g, 40, 60, W-80, 200, 14); g.fill(); g.stroke();
      g.beginPath(); g.rect(40,60,W-80,200); g.clip();

      if (!stopped){
        const targetScroll = targetX - centerX;
        const dist = targetScroll - x;
        const k = 4.5, damp=2.2;
        speed = speed + (dist* k - speed*damp) * dt;
        x += speed * dt;
        if (Math.abs(dist) < 4 && Math.abs(speed)<20){ stopped=true; speed=0; burst(); }
      } else { hold += dt; }

      for (let i=0;i<reel.length;i++){
        const cx = 40 + i*ITEM_W - x + ITEM_W/2;
        const cy = 160;
        if (cx < -ITEM_W || cx > W+ITEM_W) continue;

        g.fillStyle = "rgba(255,255,255,.08)";
        roundRect(g, cx-ITEM_W/2+8, cy-60, ITEM_W-16, 120, 10); g.fill();

        if (reel[i] === "?"){
          drawPigVariant(g, cx, cy, 110, "pink", null, false, false);
        } else {
          drawPigVariant(g, cx, cy, 110, reel[i], null, false, false);
        }
      }
      g.restore();

      g.save(); g.translate(centerX, 60); g.fillStyle="#fff";
      g.beginPath(); g.moveTo(0,-14); g.lineTo(10,0); g.lineTo(-10,0); g.closePath(); g.fill(); g.restore();

      for (let i=parts.length-1;i>=0;i--){
        const p=parts[i]; p.vy += 900*dt; p.x += p.vx*dt; p.y += p.vy*dt; p.a -= 1.5*dt;
        if (p.a<=0){ parts.splice(i,1); continue; }
        g.globalAlpha=p.a; g.fillStyle=p.g; g.beginPath(); g.arc(p.x,p.y,p.r,0,Math.PI*2); g.fill(); g.globalAlpha=1;
      }

      if ((hold>1.1 && !running) || hold>1.6){
        unboxModal.classList.remove('show');
        resolve(result);
        return;
      }
      requestAnimationFrame(frame);
    }
    requestAnimationFrame((t)=>{ last=t; frame(t); });
  });
}

/* Buy capsule */
document.getElementById('buyCapsule').addEventListener('click', async ()=>{
  const COST=50, REFUND=35;
  if(!spend(COST)) return;
  const pool=["black","angel","roasted"];
  const roll = await unboxCapsule(pool);
  const r = grantPig(roll);
  capsuleMsg.innerHTML = r.dup
    ? `Duplicate <b>${PIGS.find(p=>p.id===roll).name}</b> ‚Üí refund <b>${REFUND} ü•ï</b>.`
    : `You got <b>${PIGS.find(p=>p.id===roll).name}</b>! Auto-equipped.`;
  if (r.dup){ S.carrots += REFUND; updateCarrots(); saveState(); }
  renderAll();
});

/* ================ Cards ================ */
function clearCanvas(c){ const g=c.getContext('2d'); g.clearRect(0,0,c.width,c.height); g.fillStyle="#fff"; g.fillRect(0,0,c.width,c.height); }

function pigCard(p){
  const wrap=document.createElement('div'); wrap.className='card';
  const c=document.createElement('canvas'); c.width=320; c.height=200; wrap.appendChild(c);
  const meta=document.createElement('div'); meta.className='meta'; meta.innerHTML=`<div class="name">${p.name}</div><div class="price">‚Äî</div>`; wrap.appendChild(meta);
  const btn=document.createElement('button'); wrap.appendChild(btn);

  const owned=S.pigsOwned.includes(p.id);
  if (owned){
    const eq=(S.equippedPig===p.id);
    btn.textContent = eq ? "Equipped" : "Equip";
    btn.className = eq ? "own" : "equip";
    btn.onclick = ()=>{ S.equippedPig=p.id; saveState(); renderAll(); toast("Equipped "+p.name); };
  } else {
    btn.textContent = "Locked (Capsule)";
    btn.className = "own"; btn.disabled=true;
  }

  const g=c.getContext('2d');
  const paint = ()=>{ clearCanvas(c); drawPigVariant(g, 160, 110, 150, p.id, (S.equippedPig===p.id)?S.equippedCosmetic:null, !owned, false); };
  paint();
  onBasePigReady(paint);   // ‚Üê ensure this card repaints when the image loads

  return wrap;
}

function cosmeticCard(cos){
  const wrap=document.createElement('div'); wrap.className='card';
  const c=document.createElement('canvas'); c.width=320; c.height=200; wrap.appendChild(c);
  const meta=document.createElement('div'); meta.className='meta'; meta.innerHTML=`<div class="name">${cos.name}</div><div class="price">${cos.price} ü•ï</div>`; wrap.appendChild(meta);
  const btn=document.createElement('button'); wrap.appendChild(btn);

  const owned=S.cosmeticsOwned.includes(cos.id);
  if(owned){
    const eq=(S.equippedCosmetic===cos.id);
    btn.textContent = eq ? "Equipped" : "Equip";
    btn.className = eq ? "own" : "equip";
    btn.onclick = ()=>{ S.equippedCosmetic=cos.id; saveState(); renderAll(); toast("Equipped "+cos.name); };
  }else{
    btn.textContent = `Buy (${cos.price} ü•ï)`; btn.className="cta";
    btn.onclick = ()=>{ if(!spend(cos.price)) return; S.cosmeticsOwned.push(cos.id); S.equippedCosmetic=cos.id; saveState(); renderAll(); toast("Purchased "+cos.name); };
  }

  const g=c.getContext('2d');
  function paint(){
    clearCanvas(c);
    const cx=160, standY=142;
    drawStand(g, cx, standY, 90, 14, 0.20);
    if (cos.id==="top-hat")      drawTopHat(g, cx, standY, 1.0);
    if (cos.id==="traffic-cone") drawTrafficCone(g, cx, standY, 1.0);
  }
  paint();
  return wrap;
}

/* Equipped preview ‚Äî repaint when basePig is ready */
function renderEquipped(){
  const g=equippedPrev.getContext('2d'); clearCanvas(equippedPrev);
  const paint = ()=>{ clearCanvas(equippedPrev); drawPigVariant(g, 150, 110, 150, S.equippedPig, S.equippedCosmetic, false, false); };
  paint();
  onBasePigReady(paint);
  const pigName = ({"pink":"Pink Pig","black":"Black Pig","angel":"Angel Pig","roasted":"Roasted Pig"})[S.equippedPig] || "Pig";
  const cosName = S.equippedCosmetic ? (S.equippedCosmetic==="top-hat" ? "Top Hat" : "Traffic Cone") : "None";
  equippedSummary.textContent = `Pig: ${pigName} ‚Ä¢ Cosmetic: ${cosName}`;
}

/* Render */
function renderPigs(){ pigsGrid.innerHTML=""; PIGS.forEach(p=>pigsGrid.appendChild(pigCard(p))); }
function renderCosmetics(){ cosGrid.innerHTML=""; COSMETICS.forEach(c=>cosGrid.appendChild(cosmeticCard(c))); }
function renderAll(){ updateCarrots(); renderPigs(); renderCosmetics(); renderEquipped(); }

/* Init */
updateCarrots(); renderAll();
window.addEventListener('storage', (e)=>{ if (e.key===KEY){ S=loadState(); renderAll(); }});
</script>
</body>
</html>